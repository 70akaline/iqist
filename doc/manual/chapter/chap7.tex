\chapter{AUXILIARY TOOLS}
\section{{\jasmine} component}
When the Coulomb interaction is general in the local Hamiltonian $H_{\text{loc}}$, as discussed above, we have to diagonalize $H_{\text{loc}}$ in advance to obtain its eigenvalues, eigenvectors, and the $F$-matrix. In general, the local Hamiltonian is defined as
\begin{equation}
H_{\text{loc}} = H_{\text{int}} + H_{\text{cf}} + H_{\text{soc}},
\end{equation}
where $H_{\text{int}}$ means the Coulomb interaction term, $H_{\text{cf}}$ the CF splitting term, and $H_{\text{soc}}$ the SOC interaction. The \texttt{JASMINE} component is used to solve this Hamiltonian and generate necessary inputs for some CT-HYB impurity solvers (i.e., \texttt{BEGONIA}, \texttt{LAVENDER}, \texttt{PANSY}, and \texttt{MANJUSHAKA} components).

The \texttt{JASMINE} component will build $H_{\text{loc}}$ in the Fock representation at first. For the Coulomb interaction term $H_{\text{int}}$, both Kanamori parameterized and Slater parameterized forms are supported. In other words, users can use $U$ and $J$, or Slater integrals $F^{k}$ to define the Coulomb interaction matrix as they wish. For the CF splitting term $H_{\text{cf}}$, either diagonal or non-diagonal elements are accepted. The SOC term $H_{\text{soc}}$ is defined as follows,
\begin{equation}
H_{\text{soc}} = \lambda \sum_i \vec{\mathbf{l}}_i \cdot \vec{\mathbf{s}}_i,
\end{equation}
where $\lambda$ is the strength for SOC. Note that the SOC term can only be activated for the 3-, 5-, and 7-band systems.

Next, the \texttt{JASMINE} component will diagonalize $H_{\text{loc}}$ to get all eigenvalues and eigenvectors. There are two running modes for \texttt{JASMINE}. (1) It diagonalizes $H_{\text{loc}}$ in the full Hilbert space directly to obtain the eigenvalues $E_{\alpha}$ and eigenvectors $\Gamma_{\alpha}$, then the $F$-matrix is built from the eigenvectors,
\begin{equation}
(F_{i})_{\alpha,\beta} = \langle\Gamma_{\alpha}|F_{i}|\Gamma_{\beta}\rangle,
\end{equation}
where $i$ is the flavor index. The eigenvalues and $F$-matrix will be fed into the \texttt{BEGONIA} and \texttt{LAVENDER} components as necessary input data. (2) It diagonalizes each subspace of $H_{\text{loc}}$ according to the selected GQNs. Currently, four GQNs schemes for various types of $H_{\text{loc}}$ are supported, which are listed in Table~\ref{table:good}. \texttt{JASMINE} also builds indices to record the evolution sequence depicted in Eq.~(\ref{equ:next_sect}). According to the indices, it builds the $F$-matrix between two different subspaces. The eigenvalues, the indices, and the $F$-matrix will be collected and written into a disk file (atom.cix), which will be read by the \texttt{PANSY} and \texttt{MANJUSHAKA} components.

Apart from this, the \texttt{JASMINE} component will also generate the matrix elements of some physical operators, such as $\vec{L}^2$, $L_{z}$, $\vec{S}^2$, $S_{z}$, $\vec{J}^2$, and $J_{z}$, etc. They can be used by the other post-processing codes to analyze the averaged expectation value of these operators.

\section{{\hibiscus} component}
In the \texttt{HIBISCUS} component, many auxiliary tools are provided to deal with the output data of the CT-HYB impurity solvers. Here we briefly describe some of these tools:

\underline{Maximum entropy method}

In the Monte Carlo community, the maximum entropy method~\cite{mem:1996} is often used to extract the spectral function $A(\omega)$ from the imaginary time Green's function $G(\tau)$. Thus, in the \texttt{HIBISCUS} component, we implemented the standard maximum entropy algorithm. In the EDMFT calculations, sometimes we have to perform analytical continuation for the retarded interaction function $\mathcal{U}(i\nu)$ to obtain $\mathcal{U}(\nu)$. So we developed a modified version of the maximum entropy method to enable this calculation.

\underline{Stochastic analytical continuation}

An alternative way to extract the $A(\omega)$ from $G(\tau)$ is the stochastic analytical continuation~\cite{arXiv:0403055}. Unlike the maximum entropy method, the stochastic analytical continuation does not depend on any \emph{a priori} parameters. It has been argued that the stochastic analytical continuation can produce more accurate spectral functions with more subtle structures. In the \texttt{HIBISCUS} component, we also implemented the stochastic analytical continuation which can be viewed as a useful complementary procedure to the maximum entropy method. Since the stochastic analytical continuation is computationally much heavier than the maximum entropy method, we parallelized it with MPI and OpenMP.

\underline{Kramers-Kronig transformation}

Once the analytical continuation is finished, we can obtain the spectral function $A(\omega)$ and the imaginary part of the real-frequency Green's function $\Im G(\omega)$,
\begin{equation}
A(\omega) = -\frac{\Im G(\omega)}{\pi}.
\end{equation}
From the well-known Kramers-Kronig transformation, the real part of $G(\omega)$ can be determined as well:
\begin{equation}
\Re G(\omega) = -\frac{1}{\pi} \int^{\infty}_{-\infty} \text{d}\omega^{\prime} \frac{\Im G(\omega)}{\omega - \omega^{\prime}}.
\end{equation}
In the \texttt{HIBISCUS} component, we offer a Python script to do this job.

\underline{Analytical continuation for the self-energy function: Pad\'{e} approximation}

To calculate real physical quantities, such as the optical conductivity, Seebeck coefficient, thermopower, etc., the self-energy function on the real axis is an essential input. With the Pad\'{e} approximation~\cite{pade}, we can convert the self-energy function from the Matsubara frequency to real frequency axis. We implemented the Pad\'{e} approximation for $\Sigma(i\omega_n)$ in the \texttt{HIBISCUS} component.

\underline{Analytical continuation for the self-energy function: Gaussian polynomial fitting}

The calculated results for the self-energy function on the real axis using Pad\'{e} approximation strongly depend on the numerical accuracy of the original self-energy data. However, the CT-HYB/DMFT calculations yield a Matsubara self-energy function with numerical noise~\cite{PhysRevB.76.205120}. In this case, the Pad\'{e} approximation does not work well. To overcome this problem, Haule \emph{et al.}~\cite{PhysRevB.81.195107} suggested to split the Matsubara self-energy function into a low-frequency part and high-frequency tail. The low-frequency part is fitted by some sort of model functions which depends on whether the system is metallic or insulating, and the high-frequency part is fitted by modified Gaussian polynomials. It was shown that their trick works quite well even when the original self-energy function is noisy, and is superior to the Pad\'{e} approximation in all cases. Thus, in the \texttt{HIBISCUS} component, we also implemented this algorithm. It has broad applications in the LDA + DMFT calculations~\cite{RevModPhys.78.865}.

\subsection{Maximum entropy method: entropy1}
\subsection{Maximum entropy method: entropy2}
\subsection{Stochastic analytical continuation: sac}
\subsection{Analytical continuation for self-energy: swing}
\subsection{toolbox/makechi}
\subsection{toolbox/makedos}
\subsection{toolbox/makekra}
\subsection{toolbox/makescr}
\subsection{toolbox/makesig}
\subsection{toolbox/makestd}
\subsection{toolbox/maketau}
\subsection{toolbox/makeups}
\subsection{script/pysci.py}
\subsection{script/check.py}
\section{Parquet component}
As discussed in Sec.~\ref{subsec:parquet}, the DMFT + Parquet formalism is a post-processing tool of the $i$QIST package, which can be used to obtain the temperature dependence of various interaction-driven instabilities (ferromagnetic, antiferromagnetic, charge-order, superconductivity) of the system, and furthermore valuable spatial correlation information which is missing in the single-site DMFT. In the DMFT + Parquet code, one takes the lattice single-particle Green's function $G(P)$ and local irreducible vertex functions $\Gamma(\omega,\omega',\nu)$ as input, and then uses the Bethe-Salpeter equation and Parquet equations to incorporate momentum-dependence into the lattice two-particle correlation and vertex functions. In practical calculations, due to the huge memory requirements for saving the two-particle quantities [$\chi(P,P',Q)$ and $\Gamma(P,P',Q)$ are three-dimension tensor with double precision complex elements] and the instability issues occurring when performing operations on them (contraction, multiplication, inversion, etc.), one can perform one-shot calculations instead of two-particle self-consistent calculations. A scheme with true self-consistent calculation at both the single- and two-particle level, are still under development. Nevertheless, with the two-particle correlation and vertex functions obtained with the DMFT + Parquet code, one can  analyze the gap equation [i.e., Eq.~(\ref{eq:gapeq})] in various interaction channels, to study the instabilities of the system due to competition between lattice, spin, orbital and multi-orbital interactions.
